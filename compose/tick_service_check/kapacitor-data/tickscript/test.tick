// This obviously isn't a service checking script. It doesn't have flipflop
// protection, it just writes to a log file when one of the servers isn't reachable


stream

.from().measurement('exec_apache_check')
//.eval(lambda: "time", lambda: "host", lambda: "response")
//    .as("time", "host", "response")
    .alert()
        .id('{{index .Tags "host" }}:{{ .Name }}')
        .message('{{ .ID }} is {{ .Level }}, response value: {{ index .Fields "response" }}')
        .crit(lambda: "response" < 1)
        .log('/kapacitor-data/scriptlogs/basic_check.log')


