// This obviously isn't a service checking script. It doesn't have flipflop
// protection, it just writes to a log file when one of the servers isn't reachable


stream

.from().measurement('exec_apache_check')
    .alert()
        .id('{{index .Tags "host" }}:{{ .Name }}')
        .message('{{ .ID }} is {{ .Level }}, response value: {{ index .Fields "response" }}')
        .warn(lambda: ("response" < 200) OR ("response" >= 300 ))
        .crit(lambda: "response" == 0)
        .stateChangesOnly()
        .log('/kapacitor-data/scriptlogs/basic_check.log')
